var products = [
    {
        image: 'img-1-1.png',
        name: 'Cơm Cá Đỏ Sốt Teriyaki',
        price: '99,000',
        type: 'bento',
        masp: 'bento0'
    },
    {
        image: 'img-1-2.png',
        name: 'Cơm Bento Thịt Heo Chiên Xù Sốt Tonkatsu',
        price: '99,000',
        type: 'bento',
        masp: 'bento1'
    },
    {
        image: 'img-1-6.png',
        name: 'Cơm Cá Hồi Sốt Teriyaki',
        price: '159,000',
        type: 'bento',
        masp: 'bento2'
    },
    {
        image: 'img-1-7.png',
        name: 'Cơm Tôm Chiên Xù',
        price: '169,000',
        type: 'bento',
        masp: 'bento3'
    },
    {
        image: 'img-1-8.png',
        name: 'Cơm Hải Sản',
        price: '169,000',
        type: 'bento',
        masp: 'bento4'
    },
    {
        image: 'img-1-9.png',
        name: 'Cơm Lươn Nhật',
        price: '189,000',
        type: 'bento',
        masp: 'bento5'
    },
    {
        image: 'img-1-1.png',
        name: 'Cơm Cá Đỏ Sốt Teriyaki',
        price: '99,000',
        type: 'bento',
        masp: 'bento6'
    },
    {
        image: 'img-1-2.png',
        name: 'Cơm Bento Thịt Heo Chiên Xù Sốt Tonkatsu',
        price: '99,000',
        type: 'bento',
        masp: 'bento7'
    },
    {
        image: 'img-1-6.png',
        name: 'Cơm Cá Hồi Sốt Teriyaki',
        price: '159,000',
        type: 'bento',
        masp: 'bento8'
    },
    {
        image: 'img-1-7.png',
        name: 'Cơm Tôm Chiên Xù',
        price: '169,000',
        type: 'bento',
        masp: 'bento9'
    },
    {
        image: 'img-1-8.png',
        name: 'Cơm Hải Sản',
        price: '169,000',
        type: 'bento',
        masp: 'bento10'
    },
    {
        image: 'img-1-9.png',
        name: 'Cơm Lươn Nhật',
        price: '189,000',
        type: 'bento',
        masp: 'bento11'
    },
    {
        image: 'img-0-1.png',
        name: 'Tempura Roll',
        price: '118,000',
        type: 'sushi',
        masp: 'sushi0'
    },
    {
        image: 'img-0-2.png',
        name: 'Grilled Salmon Roll',
        price: '129,000',
        type: 'sushi',
        masp: 'sushi1'
    },
    {
        image: 'img-0-3.png',
        name: 'Kani Crunchy Roll',
        price: '153,000',
        type: 'sushi',
        masp: 'sushi2'
    },
    {
        image: 'img-1-1.png',
        name: 'Cơm Cá Đỏ Sốt Teriyaki',
        price: '99,000',
        type: 'bento',
        masp: 'bento12'
    },
    {
        image: 'img-0-4.png',
        name: 'Soft Shell Crab Roll',
        price: '168,000',
        type: 'sushi',
        masp: 'sushi3'
    },
    {
        image: 'img-0-5.png',
        name: 'Avocado Roll',
        price: '95,000',
        type: 'sushi',
        masp: 'sushi4'
    },
    {
        image: 'img-0-6.png',
        name: 'Tokachi Grilled Roll',
        price: '159,000',
        type: 'sushi',
        masp: 'sushi5'
    },
    {
        image: 'img-0-7.png',
        name: 'Unagi Roll',
        price: '280,000',
        type: 'sushi',
        masp: 'sushi6'
    },
    {
        image: 'img-0-8.png',
        name: 'Spicy Ebi Roll',
        price: '118,000',
        type: 'sushi',
        masp: 'sushi7'
    },
    {
        image: 'img-0-9.png',
        name: 'Cơm Cuộn Rồng Xanh',
        price: '79,000',
        type: 'sushi',
        masp: 'sushi8'
    },
    {
        image: 'img-0-10.png',
        name: 'Cơm Cuộn California',
        price: '139,000',
        type: 'sushi',
        masp: 'sushi9'
    },
    {
        image: 'img-0-11.png',
        name: 'Cơm Cuộn Cá Hồi Nướng Tái',
        price: '139,000',
        type: 'sushi',
        masp: 'sushi10'
    },
    {
        image: 'img-0-12.png',
        name: 'Cơm Cuộn Tôm Chiên Tempura',
        price: '179,000',
        type: 'sushi',
        masp: 'sushi11'
    },
    {
        image: 'img-0-13.png',
        name: 'Cơm Cuộn Cầu Vồng',
        price: '179,000',
        type: 'sushi',
        masp: 'sushi12'
    },
    {
        image: 'img-0-14.png',
        name: 'Cơm Cuộn Lươn Phô Mai',
        price: '199,000',
        type: 'sushi',
        masp: 'sushi13'
    },
    {
        image: 'img-0-15.png',
        name: 'Cơm Cuộn Hải Sản',
        price: '199,000',
        type: 'sushi',
        masp: 'sushi14'
    },
    {
        image: 'img-2-1.png',
        name: 'Sashimi Ốc Bulot Ireland',
        price: '189,000',
        type: 'sashi',
        masp: 'sashi0'
    },
    {
        image: 'img-2-2.png',
        name: 'Sashimi Cá Chim Việt Nam',
        price: '199,000',
        type: 'sashi',
        masp: 'sashi1'
    },
    {
        image: 'img-2-3.png',
        name: 'Sashimi Cá Mú Việt Nam',
        price: '219,000',
        type: 'sashi',
        masp: 'sashi2'
    },
    {
        image: 'img-2-4.png',
        name: 'Sashimi Tôm Sú Việt Nam',
        price: '249,000',
        type: 'sashi',
        masp: 'sashi3'
    },
    {
        image: 'img-2-5.png',
        name: 'Sashimi Cá Bơn Hàn Quốc',
        price: '399,000',
        type: 'sashi',
        masp: 'sashi4'
    },
    {
        image: 'img-2-6.png',
        name: 'Sashimi Bào Ngư Hàn Quốc',
        price: '499,000',
        type: 'sashi',
        masp: 'sashi5'
    },
    {
        image: 'img-2-7.png',
        name: 'Sashimi Ốc Vòi Voi',
        price: '889,000',
        type: 'sashi',
        masp: 'sashi6'
    },
    {
        image: 'img-2-8.png',
        name: 'Sashimi Bạch Tuộc',
        price: '169,000',
        type: 'sashi',
        masp: 'sashi7'
    },
    {
        image: 'img-2-9.png',
        name: 'Sashimi Trứng Cá Hồi',
        price: '239,000',
        type: 'sashi',
        masp: 'sashi8'
    },
    {
        image: 'img-2-10.png',
        name: 'Sashimi Bụng Cá Cam',
        price: '299,000',
        type: 'sashi',
        masp: 'sashi9'
    },
    {
        image: 'img-2-11.png',
        name: 'Sashimi Bụng Cá Hồi',
        price: '219,000',
        type: 'sashi',
        masp: 'sashi10'
    },
    {
        image: 'img-2-12.png',
        name: 'Sashimi Cá Trích Ép Trứng Đỏ',
        price: '169,000',
        type: 'sashi',
        masp: 'sashi11'
    },
    {
        image: 'img-2-13.png',
        name: 'Sashimi Cá Trích Ép Trứng Vàng',
        price: '169,000',
        type: 'sashi',
        masp: 'sashi12'
    },
    {
        image: 'img-2-14.png',
        name: 'Sashimi Cồi Sò Điệp Nhật',
        price: '239,000',
        type: 'sashi',
        masp: 'sashi13'
    },
    {
        image: 'img-2-15.png',
        name: 'Sashimi Sò Đỏ Hokkigai',
        price: '239,000',
        type: 'sashi',
        masp: 'sashi14'
    },
    {
        image: 'img-2-16.png',
        name: 'Sashimi Trứng Cá Chuồn',
        price: '169,000',
        type: 'sashi',
        masp: 'sashi15'
    },
    {
        image: 'img-2-17.png',
        name: 'Sashimi Thân Cá Hồi',
        price: '199,000',
        type: 'sashi',
        masp: 'sashi16'
    },
    {
        image: 'img-2-2.png',
        name: 'Sashimi Cá Chim Việt Nam',
        price: '199,000',
        type: 'sashi',
        masp: 'sashi17'
    },
    {
        image: 'img-2-4.png',
        name: 'Sashimi Tôm Sú Việt Nam',
        price: '249,000',
        type: 'sashi',
        masp: 'sashi18'
    },
    {
        image: 'img-2-6.png',
        name: 'Sashimi Bào Ngư Hàn Quốc',
        price: '499,000',
        type: 'sashi',
        masp: 'sashi19'
    },
    {
        image: 'img-2-8.png',
        name: 'Sashimi Bạch Tuộc',
        price: '169,000',
        type: 'sashi',
        masp: 'sashi20'
    },
    {
        image: 'img-2-10.png',
        name: 'Sashimi Bụng Cá Cam',
        price: '299,000',
        type: 'sashi',
        masp: 'sashi21'
    },
    {
        image: 'img-3-1.png',
        name: 'Combo Sashimi 3A',
        price: '269,000',
        type: 'combo',
        masp: 'combo0'
    },
    {
        image: 'img-3-2.png',
        name: 'Combo Sashimi 3B',
        price: '289,000',
        type: 'combo',
        masp: 'combo1'
    },
    {
        image: 'img-3-3.png',
        name: 'Combo Sashimi 3C',
        price: '319,000',
        type: 'combo',
        masp: 'combo2'
    },
    {
        image: 'img-3-4.png',
        name: 'Combo Sashimi 3D',
        price: '349,000',
        type: 'combo',
        masp: 'combo3'
    },
    {
        image: 'img-3-5.png',
        name: 'Combo Sashimi 3E',
        price: '389,000',
        type: 'combo',
        masp: 'combo4'
    },
    {
        image: 'img-3-6.png',
        name: 'Combo Sashimi 3F',
        price: '598,000',
        type: 'combo',
        masp: 'combo5'
    },
    {
        image: 'img-3-7.png',
        name: 'Combo Sashimi 5A',
        price: '499,000',
        type: 'combo',
        masp: 'combo6'
    },
    {
        image: 'img-3-8.png',
        name: 'Combo Sashimi 5B',
        price: '549,000',
        type: 'combo',
        masp: 'combo7'
    },
    {
        image: 'img-3-9.png',
        name: 'Combo Sashimi 5C',
        price: '849,000',
        type: 'combo',
        masp: 'combo8'
    },
    {
        image: 'img-3-10.png',
        name: 'Combo Sashimi 5D',
        price: '749,000',
        type: 'combo',
        masp: 'combo9'
    },
    {
        image: 'img-3-11.png',
        name: 'Combo Sashimi 7A',
        price: '999,000',
        type: 'combo',
        masp: 'combo10'
    },
    {
        image: 'img-3-12.png',
        name: 'Combo Sashimi 7B',
        price: '999,000',
        type: 'combo',
        masp: 'combo11'
    },
    {
        image: 'img-3-13.png',
        name: 'Combo Sashimi 7C',
        price: '990,000',
        type: 'combo',
        masp: 'combo12'
    },
    {
        image: 'img-3-14.png',
        name: 'Combo Sashimi Hoàng Gia',
        price: '2,249,000',
        type: 'combo',
        masp: 'combo13'
    },
    {
        image: 'img-4-1.png',
        name: 'Bánh Xèo Nhật',
        price: '89,000',
        type: 'ankem',
        masp: 'ankem0'
    },
    {
        image: 'img-4-2.png',
        name: 'Cá Hồi Sốt Teriyaki',
        price: '99,000',
        type: 'ankem',
        masp: 'ankem1'
    },
    {
        image: 'img-4-3.png',
        name: 'Đậu Nành Nhật',
        price: '35,000',
        type: 'ankem',
        masp: 'ankem2'
    },
    {
        image: 'img-4-4.png',
        name: 'Gừng Hồng',
        price: '10,000',
        type: 'ankem',
        masp: 'ankem3'
    },
    {
        image: 'img-4-5.png',
        name: 'Lá Tía Tô',
        price: '10,000',
        type: 'ankem',
        masp: 'ankem4'
    },
    {
        image: 'img-4-6.png',
        name: 'Lẩu Hải Sản Cay',
        price: '399,000',
        type: 'ankem',
        masp: 'ankem5'
    },
    {
        image: 'img-4-7.png',
        name: 'Mì Udon Hải Sản Cay',
        price: '199,000',
        type: 'ankem',
        masp: 'ankem6'
    },
    {
        image: 'img-4-8.png',
        name: 'Rong Nho',
        price: '99,000',
        type: 'ankem',
        masp: 'ankem7'
    },
    {
        image: 'img-4-9.png',
        name: 'Salad Cá Hồi Da Giòn',
        price: '119,000',
        type: 'ankem',
        masp: 'ankem8'
    },
    {
        image: 'img-4-10.png',
        name: 'Salad Hải Sản Sốt Hành Tây',
        price: '169,000',
        type: 'ankem',
        masp: 'ankem9'
    },
    {
        image: 'img-4-11.png',
        name: 'Salad Wakame',
        price: '69,000',
        type: 'ankem',
        masp: 'ankem10'
    },
    {
        image: 'img-4-12.png',
        name: 'Soup Miso Đầu Cá Bơn',
        price: '79,000',
        type: 'ankem',
        masp: 'ankem11'
    },
    {
        image: 'img-4-13.png',
        name: 'Soup Miso Đầu Cá Chim',
        price: '79,000',
        type: 'ankem',
        masp: 'ankem12'
    },
    {
        image: 'img-4-14.png',
        name: 'Soup Miso Đầu Cá Hồi',
        price: '79,000',
        type: 'ankem',
        masp: 'ankem13'
    },
    {
        image: 'img-4-15.png',
        name: 'Wasabi Tươi',
        price: '10,000',
        type: 'ankem',
        masp: 'ankem14'
    },
    {
        image: 'img-5-1.png',
        name: 'Coca-Cola',
        price: '10,000',
        type: 'douong',
        masp: 'douong0'
    },
    {
        image: 'img-5-2.png',
        name: 'Nước Suối Dasani',
        price: '10,000',
        type: 'douong',
        masp: 'douong1'
    },
    {
        image: 'img-5-3.png',
        name: 'Tàu Hủ Tươi Sentofu - Vị Đào',
        price: '19,000',
        type: 'douong',
        masp: 'douong2'
    },
    {
        image: 'img-5-4.png',
        name: 'Tàu Hủ Tươi Sentofu - Vị Dâu',
        price: '19,000',
        type: 'douong',
        masp: 'douong3'
    },
    {
        image: 'img-5-5.png',
        name: 'Tàu Hủ Tươi Sentofu - Vị Lá Dứa',
        price: '19,000',
        type: 'douong',
        masp: 'douong4'
    },
    {
        image: 'img-5-6.png',
        name: 'Tàu Hủ Tươi Sentofu - Vị Truyền Thống',
        price: '19,000',
        type: 'douong',
        masp: 'douong5'
    },
    {
        image: 'img-5-7.png',
        name: 'Tàu Hủ Tươi Sentofu - Vị Việt Quất',
        price: '19,000',
        type: 'douong',
        masp: 'douong6'
    }
]

// Lựa chọn các item trên nav-item
const navItems = document.querySelectorAll('.nav-item');
const sectionItems = document.querySelectorAll('.section > div');

navItems.forEach(function(navItem, index) {
    navItem.onclick = function() {
        document.querySelector('.nav-item.active').classList.remove('active');
        navItem.classList.add('active');

        sectionItems.forEach(function(sectionItem) {
            sectionItem.style.display = 'none';
        })

        switch(index) {
            case 0:
                document.querySelector('.section__home').style.display = "block";
                break;
            case 1:
                document.querySelector('.section__product').style.display = "block";
                break;
            case 2:
                document.querySelector('.section__order').style.display = "block";
                break;
            case 3:
                document.querySelector('.section__customer').style.display = "block";
                break;
            case 4:
                window.location.pathname = '/html/index.html';
                break;
        }
    }
})

function splitImg(img) {
    var img2 = img.split('fakepath\\');
    if(img2.length === 1) {
        return '../images/' + img2;
    }
    else {
        return '../images/' + img2[1];
    }
}

// Xử lý gía sản phẩm
function addComma(number) {
    number = '' + number;
    if (number.length > 3) {
        var mod = number.length % 3;
        var output = (mod > 0 ? (number.substring(0,mod)) : '');
        for (i=0 ; i < Math.floor(number.length / 3); i++) {
            if ((mod == 0) && (i == 0))
                output += number.substring(mod+ 3 * i, mod + 3 * i + 3);
            else
                output+= ',' + number.substring(mod + 3 * i, mod + 3 * i + 3);
        }
        return (output);
    }
    else return number;
}

function deleteComma(s) {
    var arr = s.split(',');
    var money = '';
    for(let i=0; i < arr.length; i++) {
        money += arr[i];
    }

    return parseInt(money);
}

// Hàm lấy Loại sản phẩm
function getTypeProduct(type) {
    var a = ["Bento", "Sushi", "Sashimi", "Combo Sashimi", "Món ăn kèm", "Nước uống và tráng miệng"]
    var s;
    switch(type) {
        case 'bento':
            s = a[0];
            break;
        case 'sushi':
            s = a[1];
            break;
        case 'sashi':
            s = a[2];
            break;
        case 'combo':
            s = a[3];
            break;
        case 'ankem':
            s = a[4];
            break;
        case 'douong':
            s = a[5];
            break;
    }

    return s;
}

// Render sản phẩm ra Table
function showProduct() {
    const arr = localStorage.getItem('product') ? JSON.parse(localStorage.getItem('product')) : products;
    var htmls = '<table>';
    let temp = 1;
    for (let i = 0; i < arr.length; i++) {
        htmls += `
        <tr>
        <td style="width: 5%">${temp++}</td>
        <td style="width: 10%">${arr[i].masp}</td>
        <td style="width: 10%">${getTypeProduct(arr[i].type)}</td>
        <td style="width: 35%" class="fa__left">${arr[i].name}</td>
        <td style="width: 15%">${arr[i].price}</td>
        <td style="width: 15%"><img src="${splitImg(arr[i].image)}"></td>
        <td style="width: 10%">
            <div class="tooltip update" onclick="editProduct(${i})">
                <i class="fa fa-wrench"></i>
                <span class="tooltiptext">Sửa</span>
            </div>
            <div class="tooltip delete" onclick="deleteProduct(${i})">
                <i class="fa fa-trash"></i>
                <span class="tooltiptext">Xóa</span>
            </div>
        </td>
        </tr>`
    }
    htmls += '</table>';
    document.getElementById('table-product').innerHTML = htmls;
    localStorage.setItem("product", JSON.stringify(arr));
}

showProduct();

// Xử lý thêm sản phẩm
const addProductBtn = document.getElementById('add-product');
const overlayProduct = document.querySelector('.overlay.product.add');
const overlayProduct2 = document.querySelector('.overlay.product.edit');
const confirmAdd = document.getElementById('add-btn');
const valueType = document.querySelector('.overlay.product select');
const nameProduct = document.querySelector('.overlay.product input.name');
const imgProduct = document.querySelector('.overlay.product input[type="file"]');
const priceProduct = document.querySelector('.overlay.product input.price');
const notify = document.querySelector('.notify');

// clear
function clear() {
    imgProduct.value = "";
    document.getElementById('productImgAdd').src = "";
    nameProduct.value = "";
    priceProduct.value = "";
    valueType.value = "bento";
}

function addProduct() {
    addProductBtn.addEventListener('click', function() {
        overlayProduct.style.transform = 'scale(1)';
        autoMaSanPham();
    })
    
    confirmAdd.onclick = function() {
        const arr = localStorage.getItem('product') ? JSON.parse(localStorage.getItem('product')) : products;
        const img = splitImg(imgProduct.value);
        const name = nameProduct.value;
        const price = priceProduct.value;
        const type = valueType.value;
        const masp = document.getElementById('maspThem').value

        if(img != "" && name != "" && price != "") {
            arr.push({
                image: img,
                name: name,
                price: addComma(price),
                type: type,
                masp: masp
            })
            
            localStorage.setItem("product", JSON.stringify(arr));
            
            setTimeout(function() {
                notify.style.transform = 'translateX(0)';
                notify.style.opacity = '1';
                notify.innerHTML = `<div class="login-notify success">
                                        <i class="fa-sharp fa-solid fa-circle-check"></i>
                                        Thêm sản phẩm thành công
                                    </div>`;
            }, 200)
            
            setTimeout(function() {
                notify.style.transform = 'translateX(100%)';
                notify.style.opacity = '0';
            }, 1200)
            
            setTimeout(function() {
                overlayProduct.style.transform = 'scale(0)';
            }, 1300)
            
            showProduct();
            clear();
        }
        else {
            setTimeout(function() {
                notify.style.transform = 'translateX(0)';
                notify.style.opacity = '1';
                notify.innerHTML = `<div class="login-notify error">
                                        <i class="fa-solid fa-circle-xmark"></i>
                                        Chưa điền đủ thông tin sản phẩm !!
                                    </div>`;
                
            }, 200)
    
            setTimeout(function() {
                notify.style.transform = 'translateX(100%)';
                notify.style.opacity = '0';
            }, 1200)
        }
        notify.innerHTML = '';
    }

}

addProduct();

// Xử lý xóa sản phẩm
const notifyDelete = document.querySelector('.notify__delete');

function deleteProduct(i) {
    notifyDelete.innerHTML = `<div class="notify__delete-text">
                Bạn có chắc sẽ xóa sản phẩm này không?
            </div>
            <div class="notify__delete-btn">
                <div class="notify__delete-ok">
                    OK
                </div>
                <div class="notify__delete-cancel">
                    Hủy
                </div>
            </div>`

    setTimeout(function() {
        notifyDelete.style.transform = 'translate(-50%, 0)';
        notifyDelete.style.opacity = '1';
        document.querySelector('.notify__delete-ok').onclick = function() {
            const arr = localStorage.getItem('product') ? JSON.parse(localStorage.getItem('product')) : products;
            notifyDelete.style.transform = 'translate(-50%, -270%)';
            notifyDelete.style.opacity = '0';

            arr.splice(i, 1);

            localStorage.setItem("product", JSON.stringify(arr));
            showProduct();
        }
        document.querySelector('.notify__delete-cancel').onclick = function() {
            notifyDelete.style.transform = 'translate(-50%, -270%)';
            notifyDelete.style.opacity = '0';
        }
    }, 200)
    
}



// Sửa lỗi ảnh
function updateProductImg(files, id) {
    // var url = '';
    // if(files.length) url = window.URL.createObjectURL(files[0]);
    
    // document.getElementById(id).src = url;

    // console.log(url);

    const reader = new FileReader();
    reader.addEventListener("load", function () {
        // convert image file to base64 string
        previewSrc = reader.result;
        document.getElementById(id).src = previewSrc;
    }, false);

    if (files[0]) {
        reader.readAsDataURL(files[0]);
    }
}

// hàm tự tạo mã cho sản phẩm mới
function autoMaSanPham(sp) {
    const arr = localStorage.getItem('product') ? JSON.parse(localStorage.getItem('product')) : products;

    if(!sp)
        sp = document.getElementsByName('selectProduct')[0].value;
    var index = 0;
    for (var i = 0; i < arr.length; i++) {
        if (arr[i].type == sp) {
            index++;
        }
    }
    document.getElementById('maspThem').value = sp.substring(0, 6) + index;
}

function autoMaSanPham2(sp) {
    const arr = localStorage.getItem('product') ? JSON.parse(localStorage.getItem('product')) : products;

    if(!sp)
        sp = document.getElementsByName('selectProduct2')[0].value;
    var index = 0;
    for (var i = 0; i < arr.length; i++) {
        if (arr[i].type == sp) {
            index++;
        }
    }
    document.getElementById('maspSua').value = sp.substring(0, 6) + index;
}

// Xử lý sửa sản phẩm
function editProduct(i) {
    const arr = localStorage.getItem('product') ? JSON.parse(localStorage.getItem('product')) : products;
    autoMaSanPham()
    var htmls = `
    <div class="close" onclick="this.parentElement.style.transform = 'scale(0)';">
                        <i class="fa-solid fa-xmark"></i>
                    </div>
                    <table class="overlayTable table-outline table-content table-header">
                        <tr>
                            <th colspan="2">Xóa Sản Phẩm</th>
                        </tr>
                        <tr>
                            <td>Mã sản phẩm:</td>
                            <td><input type="text" id="maspSua" value="${arr[i].masp}"></td>
                        </tr>
                        <tr>
                            <td>Loại sản phẩm:</td>
                            <td>
                                <select name="selectProduct2" onchange="autoMaSanPham2(this.value)">`

    var tmps = ["bento", "sushi", "sashi", "combo", "ankem", "douong"];
    for(var tmp of tmps) {
        if(arr[i].type === tmp)
            htmls += (`<option value="`+tmp+`" selected>`+getTypeProduct(tmp)+`</option>`);
        else
            htmls += (`<option value="`+tmp+`">`+getTypeProduct(tmp)+`</option>`);
    }
    
    htmls += `</select>
                </td>
            </tr>
            <tr>
                <td>Tên sản phẩm:</td>
                <td><input type="text" class="name" value="${arr[i].name}"></td>
            </tr>
            <tr>
                <td>Hình ảnh:</td>
                <td>
                    <img src="${splitImg(arr[i].image)}" id="productImgEdit">
                    <input type="file" name="" id="" onchange="updateProductImg(this.files, 'productImgEdit')">
                </td>
            </tr>
            <tr>
                <td>Giá tiền:</td>
                <td><input type="text" class="price" value="${deleteComma(arr[i].price)}"></td>
            </tr>
            <tr>
                <td colspan="2" class="table-footer">
                    <button id="edit-btn">SỬA</button>
                </td>
            </tr>
        </table>`

    document.querySelector('.overlay.product.edit').innerHTML = htmls;
    overlayProduct2.style.transform = 'scale(1)';

    const editBtn = document.getElementById('edit-btn');
    
    editBtn.onclick = function() {
        const type = document.querySelector('.overlay.product.edit select').value;
        const name = document.querySelector('.overlay.product.edit input.name').value;
        const image1 = document.getElementById('productImgEdit').src;
        const price = document.querySelector('.overlay.product.edit input.price').value;
        const masp = document.getElementById('maspSua').value;
        const image2 = document.querySelector('.overlay.product.edit input[type="file"]').value;

        var image;

        if(image2 == '') {
            image = image1.split('/images/')[1];
            image = '../images/' + image;
        }
        else {
            image = splitImg(image2);
        }
    
        if(name != "" && price != "") {
            arr[i] = {
                image: image,
                name: name,
                price: addComma(price),
                type: type,
                masp: masp
            }
            
            setTimeout(function() {
                notify.style.transform = 'translateX(0)';
                notify.style.opacity = '1';
                notify.innerHTML = `<div class="login-notify success">
                                        <i class="fa-solid fa-circle-check"></i>
                                        Sửa sản phẩm thành công
                                    </div>`;
            }, 200)
            
            setTimeout(function() {
                notify.style.transform = 'translateX(100%)';
                notify.style.opacity = '0';
            }, 1200)
            
            setTimeout(function() {
                overlayProduct.style.transform = 'scale(0)';
            }, 1300)
            
            showProduct();
        }
        else {
            setTimeout(function() {
                notify.style.transform = 'translateX(0)';
                notify.style.opacity = '1';
                notify.innerHTML = `<div class="login-notify error">
                                        <i class="fa-solid fa-circle-xmark"></i>
                                        Chưa điền đủ thông tin sản phẩm !!
                                    </div>`;
            }, 200)
    
            setTimeout(function() {
                notify.style.transform = 'translateX(100%)';
                notify.style.opacity = '0';
            }, 1200)
        }
        notify.innerHTML = '';

        localStorage.setItem("product", JSON.stringify(arr));
        showProduct();

    }

}

// function changeProduct() {
//     const editBtn = document.getElementById('edit-btn');

//     editBtn.onclick = function() {
//         const type = document.querySelector('.overlay.product select').value;
//         const name = document.querySelector('.overlay.product input.name').value;
//         const img = document.querySelector('.overlay.product input[type="file"]').value;
//         const price = document.querySelector('.overlay.product input.price').value;
//         const masp = document.getElementById('maspThem').value;
        

//         if(img != "" && name != "" && price != "") {
//             arr[i] = {
//                 img: img,
//                 name: name,
//                 price: addComma(price),
//                 type: type
//             }
            
//             localStorage.setItem("product", JSON.stringify(arr));
            
//             setTimeout(function() {
//                 notify.classList.add('success');
//                 notify.innerHTML = `<i class="fa-solid fa-circle-check"></i>
//                 Sửa sản phẩm thành công`;
//                 notify.style.opacity = '1';
//             }, 200)
            
//             setTimeout(function() {
//                 notify.style.opacity = '0';
//             }, 1200)
            
//             setTimeout(function() {
//                 overlayProduct.style.transform = 'scale(0)';
//             }, 1300)
            
//             showProduct();
//         }
//         else {
//             setTimeout(function() {
//                 notify.classList.add('error');
//                 notify.innerHTML = `<i class="fa-solid fa-circle-xmark"></i>
//                                 Chưa điền đủ thông tin sản phẩm`;
//                 notify.style.opacity = '1';
//             }, 200)
    
//             setTimeout(function() {
//                 notify.style.opacity = '0';
//             }, 1200)
//         }
//         notify.classList.remove('error');
//         notify.classList.remove('success');
//         notify.innerHTML = '';
//     }
// }

// changeProduct()

/*function timSanPham() {
    const arr = JSON.parse(localStorage.getItem('product'))
    var list = [];
    var x = `
    <tr>
    <th title="Sắp xếp" style="width: 5%"">Stt</th>
    <th title="Sắp xếp" style="width: 10%"">Mã</th>
    <th title="Sắp xếp" style="width: 40%"">Tên</th>
    <th title="Sắp xếp" style="width: 15%"">Giá</th>
    <th title="Sắp xếp" style="width: 15%"">Hình Ảnh</th>
    <th style="width: 15%">Hành động</th>
    </tr>
    `
    let temp = 0;
    let temp2 = 0;
    let temp3 = 0;
    for (let i = 0; i < arr.length; i++) {
        for (let j = 0; j < arr[i].length; j++) {
            if (val == arr[i][j].name) {
                list.push(arr[i][j]);
                alert(list)
            }
        }
    }
    for (let i = 0; i < list.length; i++) {
        x += `<tr>
        <td>${temp++}</td>
        <td>${temp2++}</td>
        <td class="fa__left">${list[i].name}</td>
        <td>${list[i].price}</td>
        <td><img src="$list[i].image}"></td>
        <td>${temp3++}</td>
        </tr>`
    }
    document.getElementById('test').innerHTML = x;
}*/
